<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Xtrade Secure Login Portal">
    <meta name="author" content="Xtrade Engineering">
    <link rel="shortcut icon" href="../favicon.png" type="image/x-icon">
    <title>Xtrade | Secure Account Access</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="../../css/bootstrap.css" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="../../scripts/jquery-3.6.0.min.js"></script>

    <style>
        /**
         * Xtrade Sleek Theme Framework v2.0
         * Comprehensive Professional Styling
         */
        :root {
            --primary: #253978;
            --primary-light: #3a53a4;
            --accent: #00bfff;
            --white: #ffffff;
            --black: #000000;
            --glass-bg: rgba(255, 255, 255, 0.95);
            --glass-border: rgba(255, 255, 255, 0.3);
            --input-bg: #f8fafc;
            --input-border: #e2e8f0;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --shadow-premium: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Base Reset & Core Typography */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            color: var(--text-main);
        }

        /* Cinematic Video Background Optimization */
        #myVideo {
            position: fixed;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            z-index: -100;
            transform: translateX(-50%) translateY(-50%);
            filter: brightness(0.45) contrast(1.1) saturate(0.8);
            object-fit: cover;
        }

        /* Layout Architecture */
        .page-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            width: 100%;
            z-index: 10;
        }

        /* Navigation Refinement */
        .navbar-fixed {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: transparent;
            padding: 1rem 0;
            transition: var(--transition-smooth);
        }

        .navbar-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-links-wrapper {
            display: flex;
            gap: 12px;
        }

        .btn-nav {
            background: var(--primary);
            color: var(--white);
            border: none;
            padding: 10px 22px;
            border-radius: 10px;
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 0.3px;
            transition: var(--transition-smooth);
            text-decoration: none !important;
            box-shadow: 0 4px 12px rgba(37, 57, 120, 0.2);
        }

        .btn-nav:hover {
            background: var(--primary-light);
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(37, 57, 120, 0.3);
            color: var(--white);
        }

        /* Login Interface Core */
        .main-auth-content {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 80px 20px 40px;
        }

        .form-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 28px;
            padding: 48px !important;
            width: 100%;
            max-width: 440px;
            box-shadow: var(--shadow-premium);
            transition: var(--transition-smooth);
            z-index: 1000;
        }

        /* Professional Header Styling */
        .brand-header {
            text-align: center;
            margin-bottom: 35px;
        }

        .brand-header img {
            width: 180px;
            height: auto;
            margin-bottom: 20px;
        }

        .auth-title {
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--primary);
            letter-spacing: -0.5px;
            margin-bottom: 8px;
        }

        .auth-subtitle {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        /* Sleek Form Controls */
        .form-group-custom {
            margin-bottom: 24px;
        }

        .label-custom {
            text-transform: uppercase;
            font-size: 0.7rem;
            font-weight: 800;
            color: #4a5568;
            margin-bottom: 8px;
            display: block;
        }

        .input-custom {
            width: 100%;
            height: 56px;
            background: var(--input-bg);
            border: 1px solid var(--input-border);
            border-radius: 14px;
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-main);
            transition: var(--transition-smooth);
            outline: none;
        }

        .input-custom:focus {
            background: var(--white);
            border-color: var(--accent);
            box-shadow: 0 0 0 4px rgba(0, 191, 255, 0.1);
        }

        /* Password Group Styling */
        .password-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .password-wrapper .input-custom {
            padding-right: 50px;
        }

        .password-toggle {
            position: absolute;
            right: 18px;
            cursor: pointer;
            color: var(--text-muted);
            font-size: 1.1rem;
            transition: var(--transition-smooth);
        }

        .password-toggle:hover {
            color: var(--primary);
        }

        /* Action Buttons */
        .btn-submit {
            width: 100%;
            height: 58px;
            background: linear-gradient(135deg, var(--primary) 0%, #162655 100%);
            color: var(--white);
            border: none;
            border-radius: 14px;
            font-size: 1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 10px;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(37, 57, 120, 0.25);
            transition: var(--transition-smooth);
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(37, 57, 120, 0.4);
        }

        .btn-submit:active {
            transform: translateY(0);
        }

        /* Utility Links */
        .auth-footer-links {
            text-align: center;
            margin-top: 30px;
            border-top: 1px solid #edf2f7;
            padding-top: 25px;
        }

        .link-secondary {
            color: var(--text-muted);
            font-size: 0.9rem;
            text-decoration: none;
            transition: var(--transition-smooth);
        }

        .link-secondary:hover {
            color: var(--primary);
        }

        .link-primary-bold {
            color: var(--primary);
            font-weight: 700;
            text-decoration: none;
        }

        /* Modern Checkbox */
        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 25px;
            user-select: none;
        }

        .checkbox-custom {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        .checkbox-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            cursor: pointer;
        }

        /* Floating MGM Component */
        .mgm {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background: var(--white);
            padding: 16px 24px;
            border-radius: 18px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            display: none;
            z-index: 1000;
            border-left: 6px solid var(--primary);
            max-width: 320px;
            animation: animate__fadeInLeft 0.5s;
        }

        .mgm .txt {
            font-size: 0.85rem;
            color: var(--text-main);
            line-height: 1.5;
        }

        .mgm b { color: var(--primary); }

        /* Modern Preloader */
        #preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--white);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #f3f4f6;
            border-top: 4px solid var(--accent);
            border-radius: 50%;
            animation: spin 0.8s cubic-bezier(0.5, 0.1, 0.4, 0.9) infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Google Translate Hiding */
        .goog-te-banner-frame, .skiptranslate, #goog-gt-tt {
            display: none !important;
            visibility: hidden !important;
        }
        body { top: 0px !important; }

        /* Responsive Breakpoints */
        @media (max-width: 576px) {
            .form-card {
                padding: 30px !important;
                border-radius: 20px;
            }
            .navbar-content {
                padding: 0 1rem;
            }
            .btn-nav {
                padding: 8px 14px;
                font-size: 0.75rem;
            }
        }
    </style>
</head>

<body class="menuclose">

    <figure class="background">
        <video autoplay muted loop id="myVideo" playsinline>
            <source src="../../account/bg.mp4" type="video/mp4">
        </video>
    </figure>

    <header class="navbar-fixed">
        <div class="navbar-content">
            <a href="../../" class="imglogo">
                <img src="../../media/logo_header+dark.png" alt="Xtrade Logo" style="height: 35px;">
            </a>
            <div class="nav-links-wrapper">
                <a href="#" class="btn-nav navs" data-key="home">Home</a>
                <a href="#" class="btn-nav navs" data-key="register">Register</a>
            </div>
        </div>
    </header>

    <div class="page-container">
        <main class="main-auth-content">
            <div class="form-card animate__animated animate__fadeInUp">
                
                <div class="brand-header">
                    <img src="../../media/logo_header+dark.png" alt="Xtrade">
                    <h1 class="auth-title">Welcome Back</h1>
                    <p class="auth-subtitle">Securely access your trading dashboard</p>
                </div>

                <div id="formMessage" style="display:none; margin-bottom:15px;" class="alert"></div>

                <form class="form-signin1" action="" method="POST">
                    
                    <div class="form-group-custom">
                        <label class="label-custom">Email or Username</label>
                        <input type="text" name="username" class="input-custom" placeholder="name@example.com" required>
                    </div>

                    <div class="form-group-custom">
                        <label class="label-custom">Secure Password</label>
                        <div class="password-wrapper">
                            <input type="password" name="password" class="input-custom" id="pwd" placeholder="••••••••" required>
                            <span id="eye" onclick="vPwd()" class="password-toggle fa fa-eye-slash"></span>
                        </div>
                    </div>

                    <div class="checkbox-wrapper">
                        <input type="checkbox" name="remember" id="remember" class="checkbox-custom">
                        <label for="remember" class="checkbox-label">Keep me signed in for 30 days</label>
                    </div>

                    <button type="submit" name="login_btn" class="btn-submit">
                        Continue to Account
                    </button>

                    <div class="auth-footer-links">
                        <p class="link-secondary">
                            New to Xtrade? <a href="#" data-key="register" class="link-primary-bold navs">Create an account</a>
                        </p>
                        <a href="#" class="link-secondary navs" data-key="forgot">Unable to log in?</a>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <div id="preloader">
        <div class="spinner"></div>
    </div>

    <div class="mgm">
        <div class="txt"></div>
    </div>

    <script>
        /**
         * Global Configuration & State
         */
        const CONFIG = {
            API_URL: 'https://xtrade3-ri76ta6k.b4a.run',
            NAV_DELAY: 2500,
            NOTIF_INTERVAL: [8000, 40000],
            AUTH_TOKEN_KEY: 'xtrade_session_active'
        };

        $(document).ready(function() {
            
            // Password Visibility Toggle Logic
            let passwordVisible = false;
            window.vPwd = function() {
                const $input = $("#pwd");
                const $icon = $("#eye");
                
                passwordVisible = !passwordVisible;
                $input.attr("type", passwordVisible ? "text" : "password");
                $icon.toggleClass("fa-eye-slash fa-eye");
            };

            // AJAX Login Orchestration
            const $loginForm = $('.form-signin1');
            const $preloader = $('#preloader');

            $loginForm.on('submit', function(e) {
                e.preventDefault();
                
                $preloader.css('display', 'flex');

                const loginData = {
                    username: $('input[name="username"]').val(),
                    password: $('input[name="password"]').val()
                };

                $.ajax({
                    url: `${CONFIG.API_URL}/account/login`,
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(loginData),
                    success: function(res) {
                        $preloader.hide();
                        
                        if (res.success && res.verified) {
                            localStorage.setItem('user_email', res.email);
                            localStorage.setItem('login_timestamp', Date.now());
                            Swal.fire({
                                icon: 'success',
                                title: 'Access Granted',
                                text: 'Syncing your secure dashboard...',
                                timer: 1500,
                                showConfirmButton: false,
                                backdrop: `rgba(37, 57, 120, 0.4)`
                            }).then(location.href = './account')
                            e.preventDefault();
                        }
                        e.preventDefault();
                    },
                    
                    error: function(xhr) {
                        $preloader.hide();
                        handleAuthError(xhr);
                    }
                });
            });

            // Error Handling Subsystem
            function handleAuthError(xhr) {
                const status = xhr.status;
                const data = xhr.responseJSON;

                let alertConfig = {
                    icon: 'error',
                    title: 'Authentication Failed',
                    text: data?.message || 'We couldn\'t verify your credentials.'
                };

                if (status === 403) {
                    if (data?.email)
                    localStorage.setItem('user_email', data.email);
                    alertConfig = {
                        icon: 'warning',
                        title: 'Verification Required',
                        text: 'Redirecting to final activation steps...',
                        timer: 2000
                    };
                    setTimeout(() => window.location.href = './process', 2000);
                } else if (status === 404) {
                    alertConfig.title = 'Account Not Found';
                    alertConfig.text = 'Redirecting to registration...';
                    setTimeout(() => window.location.href = './register', 2500);
                }

                Swal.fire(alertConfig);
            }

            // Navigation Preloader System
            const menuMap = {
                home: '../../',
                register: '../../account/register',
                forgot: '../../account/forgot'
            };

            $('.navs').on('click', function(e) {
                e.preventDefault();
                const targetKey = $(this).data('key');
                const targetUrl = menuMap[targetKey];

                if (targetUrl) {
                    $preloader.css('display', 'flex');
                    setTimeout(() => window.location.href = targetUrl, CONFIG.NAV_DELAY);
                }
            });

            // MGM Live Proof Logic
            const countries = ['United Kingdom', 'USA', 'Germany', 'Australia', 'Canada', 'Switzerland', 'Singapore', 'UAE'];
            const plans = ['£12,000', '£5,500', '£25,000', '£40,000', '£8,200', '£15,000', '$51,000', '$14,500', '$40,000', '$41,000', '$10,000', '$50,000', '$52,300', '$9,700', '$10,000', '$4,500', '$9,500', '$34,000', '$42,000', '$4,600', '$3,700', '$27,500','$58,623','$31,600'];
            const actions = ['just <b>invested</b>', 'successfully <b>withdrawn</b>', 'is <b>trading</b>'];

            function showProof() {
                const country = countries[Math.floor(Math.random() * countries.length)];
                const action = actions[Math.floor(Math.random() * actions.length)];
                const amount = plans[Math.floor(Math.random() * plans.length)];
                
                $(".mgm .txt").html(`Someone from <b>${country}</b> ${action} <b>${amount}</b>`);
                $(".mgm").fadeIn(400).delay(8000).fadeOut(400);
                
                const nextInterval = Math.floor(Math.random() * (CONFIG.NOTIF_INTERVAL[1] - CONFIG.NOTIF_INTERVAL[0])) + CONFIG.NOTIF_INTERVAL[0];
                setTimeout(showProof, nextInterval);
            }
            
            setTimeout(showProof, 5000);

            // Security Hardening
            $(document).keydown(function(e) {
                if (e.keyCode == 123 || (e.ctrlKey && e.shiftKey && (e.keyCode == 73 || e.keyCode == 74))) return false;
                if (e.ctrlKey && e.keyCode == 85) return false;
            });
            document.addEventListener('contextmenu', e => e.preventDefault());
        });

        // Background Init
        window.addEventListener('load', function() {
            document.querySelector(".background").style.opacity = "1";
        });
    </script>

    <!-- Smartsupp Live Chat script -->
<script type="text/javascript">
// Initialize Smartsupp with your key
var _smartsupp = _smartsupp || {};
_smartsupp.key = '29652789ea6476f04e0983a84b72a2508a695a1c'; // Your provided key

window.smartsupp||(function(d) {
  var s,c,o=smartsupp=function(){ o._.push(arguments)};o._=[];
  s=d.getElementsByTagName('script')[0];c=d.createElement('script');
  c.type='text/javascript';c.charset='utf-8';c.async=true;
  c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);
})(document);

/**
 * Triggered when the user clicks "Continue to Chat"
 */
function submitOtherDeposit() {
    const currencySelect = document.getElementById('currSelect');
    const selectedCurrency = currencySelect.options[currencySelect.selectedIndex].value;
    
    if (!selectedCurrency) {
        alert("Please select a currency first.");
        return;
    }

    // Open the chat box automatically
    smartsupp('chat:open');

    // Send the automated message containing the currency name
    smartsupp('chat:message', {
        text: `Hello, I would like to make a deposit using ${selectedCurrency}. Please provide the details.`,
        type: "text"
    });
}

// Search filter logic for the currency list
function filterCurrencies() {
    let input = document.getElementById('currSearch').value.toUpperCase();
    let options = document.getElementById('currSelect').getElementsByTagName('option');
    for (let opt of options) {
        opt.style.display = opt.text.toUpperCase().indexOf(input) > -1 ? "" : "none";
    }
}
</script>
</body>
</html>